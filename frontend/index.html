<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>–ü–æ–¥—Ä–∞–±–æ—Ç–∫–∏ –≤ –ú–∏–Ω—Å–∫–µ | –¢–µ—Å—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <!-- Leaflet (OpenStreetMap) -->
    <link
        rel="stylesheet"
        href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
        crossorigin=""
    />
    <script
        src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin="">
    </script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            overflow: hidden;
            height: 100vh;
            background: #000;
        }

        #map {
            width: 100%;
            height: 100vh;
        }

        .floating-button {
            position: fixed;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            border: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            font-size: 24px;
            cursor: pointer;
            z-index: 1000;
            transition: transform 0.2s;
        }

        .floating-button:active {
            transform: scale(0.95);
        }

        .btn-task {
            bottom: 20px;
            right: 20px;
            background: #ff4444;
            color: white;
        }

        .btn-worker {
            bottom: 20px;
            right: 86px;
            background: #44ff44;
            color: white;
        }

        .btn-my-listings {
            bottom: 20px;
            left: 20px;
            background: #4444ff;
            color: white;
            font-size: 20px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: white;
            border-radius: 16px;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-header {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 16px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: #333;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
        }

        .form-group textarea {
            resize: vertical;
            min-height: 80px;
        }

        .btn-submit {
            width: 100%;
            padding: 14px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 8px;
        }

        .btn-submit:active {
            background: #0056b3;
        }

        .btn-close {
            position: absolute;
            top: 12px;
            right: 12px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .hint {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            z-index: 1500;
            font-size: 16px;
            text-align: center;
            display: none;
        }

        .hint.active {
            display: block;
        }

        .listing-detail {
            padding: 16px;
        }

        .listing-detail h3 {
            margin-bottom: 12px;
            font-size: 18px;
        }

        .listing-detail p {
            margin-bottom: 8px;
            color: #666;
        }

        .listing-detail strong {
            color: #333;
        }

        .btn-contact {
            width: 100%;
            padding: 12px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 16px;
        }

        .my-listings-container {
            padding: 16px;
        }

        .tabs {
            display: flex;
            margin-bottom: 16px;
            border-bottom: 2px solid #eee;
        }

        .tab {
            flex: 1;
            padding: 12px;
            text-align: center;
            background: none;
            border: none;
            font-size: 16px;
            cursor: pointer;
            color: #666;
        }

        .tab.active {
            color: #007bff;
            border-bottom: 2px solid #007bff;
        }

        .listing-item {
            padding: 16px;
            border-bottom: 1px solid #eee;
        }

        .listing-item h4 {
            margin-bottom: 8px;
        }

        .listing-item p {
            color: #666;
            font-size: 14px;
            margin-bottom: 4px;
        }

        .btn-remove {
            margin-top: 8px;
            padding: 8px 16px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
        }

        .btn-board {
            bottom: 20px;
            left: 86px;
            background: #ff8800;
            color: white;
            font-size: 20px;
        }

        .form-group select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: inherit;
            background: white;
        }

        .location-buttons {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .btn-location {
            flex: 1;
            padding: 10px;
            background: #17a2b8;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }

        .btn-location:active {
            background: #138496;
        }

        .payment-group {
            display: flex;
            gap: 8px;
        }

        .payment-group input[type="number"] {
            flex: 2;
        }

        .payment-group select {
            flex: 1;
        }

        .board-container {
            padding: 16px;
        }

        .filters {
            margin-bottom: 16px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .filters-row {
            display: flex;
            gap: 8px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .filters-row input,
        .filters-row select {
            flex: 1;
            min-width: 120px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .board-listings {
            max-height: 60vh;
            overflow-y: auto;
        }

        .listing-card {
            padding: 16px;
            margin-bottom: 12px;
            background: white;
            border-radius: 8px;
            border: 1px solid #eee;
            cursor: pointer;
            transition: box-shadow 0.2s;
        }

        .listing-card:active {
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .listing-card-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 8px;
        }

        .listing-card-type {
            font-size: 12px;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
        }

        .listing-card-type.task {
            background: #ffebee;
            color: #c62828;
        }

        .listing-card-type.worker {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .listing-card-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 6px;
        }

        .listing-card-info {
            font-size: 14px;
            color: #666;
            margin-bottom: 4px;
        }
    </style>
</head>
<body>
    <div id="map"></div>

    <!-- –ü–ª–∞–≤–∞—é—â–∏–µ –∫–Ω–æ–ø–∫–∏ -->
    <button class="floating-button btn-task" onclick="startPlaceTask()" title="–ü–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É">üî¥</button>
    <button class="floating-button btn-worker" onclick="startPlaceWorker()" title="–Ø –∏—â—É —Ä–∞–±–æ—Ç—É">üü¢</button>
    <button class="floating-button btn-board" onclick="window.location.href='/board.html'" title="–î–æ—Å–∫–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏–π">üìã</button>
    <button class="floating-button btn-my-listings" onclick="showMyListings()" title="–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è">‚≠ê</button>

    <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ -->
    <div class="hint" id="hint">–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–µ, –≥–¥–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞</div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ -->
    <div class="modal" id="taskModal">
        <div class="modal-content">
            <button class="btn-close" onclick="closeModal('taskModal')">√ó</button>
            <div class="modal-header">üî¥ –ü–æ—Å—Ç–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É</div>
            <form id="taskForm" onsubmit="submitTask(event)">
                <div class="form-group">
                    <label>üìù –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏</label>
                    <input type="text" id="taskTitle" required placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ">
                </div>
                <div class="form-group">
                    <label>üìù –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="taskDescription" required placeholder="–ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏"></textarea>
                </div>
                <div class="form-group">
                    <label>üìç –ê–¥—Ä–µ—Å</label>
                    <input type="text" id="taskAddress" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∏–Ω—Å–∫, —É–ª. –õ–µ–Ω–∏–Ω–∞, 1">
                    <div class="location-buttons">
                        <button type="button" class="btn-location" onclick="getCurrentLocation('task')">
                            üìç –ú–æ—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è
                        </button>
                        <button type="button" class="btn-location" onclick="selectOnMap('task')">
                            üó∫Ô∏è –í—ã–±—Ä–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label>üí∞ –û–ø–ª–∞—Ç–∞</label>
                    <div class="payment-group">
                        <input type="number" id="taskPaymentAmount" required placeholder="–°—É–º–º–∞" min="0" step="0.01">
                        <select id="taskPaymentType" required>
                            <option value="BYN/—á–∞—Å">BYN/—á–∞—Å</option>
                            <option value="BYN/–¥–µ–Ω—å">BYN/–¥–µ–Ω—å</option>
                            <option value="BYN/–∑–∞–¥–∞—á–∞">BYN/–∑–∞–¥–∞—á–∞</option>
                            <option value="USD/—á–∞—Å">USD/—á–∞—Å</option>
                            <option value="USD/–¥–µ–Ω—å">USD/–¥–µ–Ω—å</option>
                            <option value="–¥–æ–≥–æ–≤–æ—Ä–Ω–∞—è">–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</label>
                    <input type="text" id="taskContacts" required placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ @username">
                </div>
                <button type="submit" class="btn-submit">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è -->
    <div class="modal" id="workerModal">
        <div class="modal-content">
            <button class="btn-close" onclick="closeModal('workerModal')">√ó</button>
            <div class="modal-header">üü¢ –Ø –∏—â—É —Ä–∞–±–æ—Ç—É</div>
            <form id="workerForm" onsubmit="submitWorker(event)">
                <div class="form-group">
                    <label>üîß –ß—Ç–æ —É–º–µ–µ—Ç–µ</label>
                    <input type="text" id="workerTitle" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –≥—Ä—É–∑—á–∏–∫, —Ä–∞–∑–Ω–æ—Ä–∞–±–æ—á–∏–π">
                </div>
                <div class="form-group">
                    <label>üìù –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ</label>
                    <textarea id="workerDescription" required placeholder="–û —Å–µ–±–µ –∏ –æ–ø—ã—Ç–µ —Ä–∞–±–æ—Ç—ã"></textarea>
                </div>
                <div class="form-group">
                    <label>üìç –ó–æ–Ω–∞ —Ä–∞–±–æ—Ç—ã</label>
                    <input type="text" id="workerAddress" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–∏–Ω—Å–∫, —Ä–∞–π–æ–Ω –£—Ä—É—á—å–µ">
                    <div class="location-buttons">
                        <button type="button" class="btn-location" onclick="getCurrentLocation('worker')">
                            üìç –ú–æ—è –≥–µ–æ–ª–æ–∫–∞—Ü–∏—è
                        </button>
                        <button type="button" class="btn-location" onclick="selectOnMap('worker')">
                            üó∫Ô∏è –í—ã–±—Ä–∞—Ç—å –Ω–∞ –∫–∞—Ä—Ç–µ
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label>üí∏ –û–ø–ª–∞—Ç–∞</label>
                    <div class="payment-group">
                        <input type="number" id="workerPaymentAmount" required placeholder="–û—Ç —Å—É–º–º—ã" min="0" step="0.01">
                        <select id="workerPaymentType" required>
                            <option value="BYN/—á–∞—Å">BYN/—á–∞—Å</option>
                            <option value="BYN/–¥–µ–Ω—å">BYN/–¥–µ–Ω—å</option>
                            <option value="BYN/–∑–∞–¥–∞—á–∞">BYN/–∑–∞–¥–∞—á–∞</option>
                            <option value="USD/—á–∞—Å">USD/—á–∞—Å</option>
                            <option value="USD/–¥–µ–Ω—å">USD/–¥–µ–Ω—å</option>
                            <option value="–¥–æ–≥–æ–≤–æ—Ä–Ω–∞—è">–î–æ–≥–æ–≤–æ—Ä–Ω–∞—è</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>üìû –ö–æ–Ω—Ç–∞–∫—Ç—ã</label>
                    <input type="text" id="workerContacts" required placeholder="–¢–µ–ª–µ—Ñ–æ–Ω –∏–ª–∏ @username">
                </div>
                <button type="submit" class="btn-submit">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –æ–±—ä—è–≤–ª–µ–Ω–∏—è -->
    <div class="modal" id="detailModal">
        <div class="modal-content">
            <button class="btn-close" onclick="closeModal('detailModal')">√ó</button>
            <div class="listing-detail" id="listingDetail"></div>
        </div>
    </div>


    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ "–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è" -->
    <div class="modal" id="myListingsModal">
        <div class="modal-content">
            <button class="btn-close" onclick="closeModal('myListingsModal')">√ó</button>
            <div class="modal-header">–ú–æ–∏ –æ–±—ä—è–≤–ª–µ–Ω–∏—è</div>
            <div class="my-listings-container">
                <div class="tabs">
                    <button class="tab active" onclick="switchTab('tasks')">–ú–æ–∏ –∑–∞–¥–∞—á–∏ üî¥</button>
                    <button class="tab" onclick="switchTab('workers')">–Ø –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å üü¢</button>
                </div>
                <div id="myListingsContent"></div>
            </div>
        </div>
    </div>

    <script src="/static/app.js"></script>
</body>
</html>

